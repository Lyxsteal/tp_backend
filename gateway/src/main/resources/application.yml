spring:
    application:
        name: gateway

    security:
        oauth2:
            resourceserver:
                jwt:
                    issuer-uri: http://localhost:8080/realms/tp_backend
            client:
                provider:
                    keycloak:
                        issuer-uri: http://localhost:8080/realms/tp_backend
                registration:
                    keycloak:
                        client-id: tp_backend_client
                        authorization-grant-type: authorization_code
                        # Usamos la URI de redirecci√≥n por defecto que Spring Security espera.
                        redirect-uri: "{baseUrl}/login/oauth2/code/keycloak"
                        scope: openid, profile, email

    cloud:
        gateway:
            routes:
                - id: whoami-local
                  uri: no://op
                  predicates:
                      - Path=/gateway/whoami
                - id: rutas
                  uri: http://ms_rutas:8085
                  predicates:
                    - Path=/api/v1/rutas/**,/api/v1/depositos/**,/api/v1/camioneros/**,/api/v1/camiones/**,/api/v1/tramos/**
                - id: solicitudes
                  uri: "http://ms_solicitud:8081"
                  predicates:
                    - Path=/api/v1/solicitudes/**, /api/v1/clientes/**, /api/v1/tarifas/**, /api/v1/contenedores/**

server:
    port: 8083

logging:
    level:
        org.springframework.cloud.gateway: DEBUG
        org.springframework.security: DEBUG
